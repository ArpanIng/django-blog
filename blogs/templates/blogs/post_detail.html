{% extends 'base.html' %}
{% load static %}
{% load markdown_extras %}
{% block title %}{{ post.title }}{% endblock title %}

{% block content %}
<main class="flex-shrink-0">
  <!-- Page Content-->
  <section class="py-5">
    <div class="container px-5 my-5">
      <div class="col-lg-9 mx-auto">
        <!-- Post content-->
        <article>
          <!-- Post header-->
          <header class="mb-4">
            <!-- Post title-->
            <h1 class="fw-bolder mb-1">{{ post.title }}</h1>
            {% if post.overview %}
              <div class="my-4">
                <h4 class="text-muted">{{ post.overview }}</h4>
              </div>
            {% endif %}
            <div class="d-flex align-items-center mt-lg-4 mb-4">
              <a href="{{ post.author.get_absolute_url }}">
                <img
                  class="rounded-circle"
                  width="40"
                  height="40"
                  src="{{ post.author.profile.image.url }}"
                  alt="{{ post.title }}"
                />
              </a>
              <div class="ms-3">
                <div>
                  <span class="fw-bold">
                    <a
                    class="text-decoration-none text-dark"
                    href="{{ post.author.get_absolute_url }}"
                    >
                      {% if post.author.first_name and post.author.last_name %}
                        {{ post.author.get_full_name }}
                      {% else %}
                        {{ post.author.username }}
                      {% endif %}
                    </a>
                  </span>
                  &middot;
                  <span>
                    <a class="text-decoration-none" href="#">Follow</a>
                  </span>
                </div>
                <div class="text-muted">
                  <span>{{ post.reading_time_minutes }} min read</span> &middot;
                  <span>{{ post.publish|date }}</span>
                </div>
              </div>

              {% if request.user == post.author %}
              <div class="ms-3">
                <a
                  class="btn btn-success"
                  href="{% url 'blogs:post_update' post.slug %}"
                  >Update
                </a>
                <!-- Button trigger modal -->
                <button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#staticBackdrop">
                  Delete
                </button>
              </div>
              {% endif %}
              {% include 'blogs/post_delete.html' %}
            </div>

            <div class="d-flex align-items-center mt-lg-4 mb-4">
              <!-- like button & counts -->
              {% include 'blogs/partials/post_likes_form.html' %}

              <!-- comments count -->
              <div class="ms-4">
                <div class="py-2">
                  <span>
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-chat" viewBox="0 0 16 16">
                      <path d="M2.678 11.894a1 1 0 0 1 .287.801 11 11 0 0 1-.398 2c1.395-.323 2.247-.697 2.634-.893a1 1 0 0 1 .71-.074A8 8 0 0 0 8 14c3.996 0 7-2.807 7-6s-3.004-6-7-6-7 2.808-7 6c0 1.468.617 2.83 1.678 3.894m-.493 3.905a22 22 0 0 1-.713.129c-.2.032-.352-.176-.273-.362a10 10 0 0 0 .244-.637l.003-.01c.248-.72.45-1.548.524-2.319C.743 11.37 0 9.76 0 8c0-3.866 3.582-7 8-7s8 3.134 8 7-3.582 7-8 7a9 9 0 0 1-2.347-.306c-.52.263-1.639.742-3.468 1.105"/>
                    </svg>
                  </span>
                  <span class="text-muted ms-1">{{ total_comments }} comment{{ total_comments|pluralize }}</span>
                </div>
              </div>
            </div>

          </header>
          <!-- Preview image figure-->
          <figure class="mb-4">
            {% if post.thumbnail %}
            <img
              class="img-fluid rounded"
              src="{{ post.thumbnail.url }}"
              alt="..."
            />
            {% endif %}
          </figure>
          <!-- Post content-->
          <section class="mb-5">
            <div class="content">
              {{ post.content|markdown|safe }}
            </div>
          </section>

          <!-- post related tag -->
          <div class="mb-4">
            {% for tag in related_tags %}
              <a href="#" class="badge rounded-pill text-bg-secondary py-2 px-3 text-decoration-none link-light">
                {{ tag.name }}
              </a>
            {% endfor %}
          </div>
          <!-- post related tag end -->

          <!-- post comment -->
        {% include 'blogs/comments.html' %}
        <!-- post comment end -->
      </div>
    </div>
  </section>
</main>

<script src="{% static 'blogs/js/post_like.js' %}"></script>

{% endblock content %}
